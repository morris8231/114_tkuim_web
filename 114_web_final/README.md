# PhotoMission - æ”å½±ä»»å‹™å­¸ç¿’ç³»çµ±

ä¸€å€‹åŸºæ–¼ç« ç¯€çš„æ”å½±å­¸ç¿’å¹³å°ï¼Œçµåˆä»»å‹™ç³»çµ±ã€ä½œå“æäº¤ã€ç¶“é©—å€¼æˆé•·æ©Ÿåˆ¶ï¼Œä»¥åŠå®Œæ•´çš„ç”¨æˆ¶ç®¡ç†å’Œç®¡ç†å“¡åˆ†æåŠŸèƒ½ã€‚

![Version](https://img.shields.io/badge/version-1.0.0-blue.svg)
![Node](https://img.shields.io/badge/node-%3E%3D14.0.0-green.svg)
![License](https://img.shields.io/badge/license-ISC-orange.svg)

---

## ğŸ“‹ ç›®éŒ„

- [åŠŸèƒ½ç‰¹è‰²](#åŠŸèƒ½ç‰¹è‰²)
- [æŠ€è¡“æ¶æ§‹](#æŠ€è¡“æ¶æ§‹)
- [ç³»çµ±éœ€æ±‚](#ç³»çµ±éœ€æ±‚)
- [å®‰è£æ­¥é©Ÿ](#å®‰è£æ­¥é©Ÿ)
- [ç’°å¢ƒè¨­å®š](#ç’°å¢ƒè¨­å®š)
- [å•Ÿå‹•å°ˆæ¡ˆ](#å•Ÿå‹•å°ˆæ¡ˆ)
- [å°ˆæ¡ˆçµæ§‹](#å°ˆæ¡ˆçµæ§‹)
- [API æ–‡ä»¶](#api-æ–‡ä»¶)
- [ç®¡ç†å“¡åŠŸèƒ½](#ç®¡ç†å“¡åŠŸèƒ½)
- [å¸¸è¦‹å•é¡Œ](#å¸¸è¦‹å•é¡Œ)

---

## âœ¨ åŠŸèƒ½ç‰¹è‰²

### ğŸ“ å­¸ç¿’ç³»çµ±
- **8 å€‹æ”å½±ç« ç¯€**ï¼šå¾åŸºç¤åˆ°é€²éšçš„å®Œæ•´æ”å½±èª²ç¨‹
- **ä»»å‹™ç³»çµ±**ï¼šæ¯å€‹ç« ç¯€åŒ…å«å¤šå€‹å¯¦ä½œä»»å‹™
- **YouTube æ•™å­¸å½±ç‰‡**ï¼šæ•´åˆç·šä¸Šæ•™å­¸è³‡æº
- **é€²åº¦è¿½è¹¤**ï¼šè‡ªå‹•è¨˜éŒ„å­¸ç¿’é€²åº¦å’Œå®Œæˆç‹€æ…‹

### ğŸ“¸ ä½œå“ç®¡ç†
- **ç…§ç‰‡ä¸Šå‚³**ï¼šæ”¯æ´å¤šå¼µç…§ç‰‡ä¸Šå‚³ï¼ˆæœ€å¤š 5 å¼µï¼‰
- **ä½œå“å±•ç¤º**ï¼šå€‹äººä½œå“é›†å’Œå…¬é–‹ç•«å»Š
- **CRUD æ“ä½œ**ï¼šå®Œæ•´çš„æ–°å¢ã€æŸ¥çœ‹ã€ç·¨è¼¯ã€åˆªé™¤åŠŸèƒ½
- **æ¯æœˆå›é¡§**ï¼šæŒ‰æœˆä»½æ•´ç†ä½œå“é›†

### ğŸ‘¤ ç”¨æˆ¶ç³»çµ±
- **Email é©—è­‰**ï¼šè¨»å†Šå¾Œéœ€é©—è­‰ Email æ‰èƒ½ä½¿ç”¨
- **JWT èªè­‰**ï¼šå®‰å…¨çš„ Token-based èº«ä»½é©—è­‰
- **å€‹äººè³‡æ–™**ï¼šæš±ç¨±ã€Emailã€è¨­å‚™é¡å‹è¨­å®š
- **ç¶“é©—å€¼ç³»çµ±**ï¼šå®Œæˆä»»å‹™ç²å¾— XP å’Œç­‰ç´šæå‡

### ğŸ”§ ç®¡ç†å“¡åŠŸèƒ½
- **åˆ†æå„€è¡¨æ¿**ï¼šå³æ™‚çµ±è¨ˆæ•¸æ“š
  - ç¶²ç«™é»æ“Šæ¬¡æ•¸ï¼ˆè¿½è¹¤æ‰€æœ‰ç”¨æˆ¶äº’å‹•ï¼‰
  - æ´»èºå¸³æˆ¶æ•¸ï¼ˆ30 å¤©å…§ç™»å…¥ï¼‰
  - ç¸½è¨»å†Šç”¨æˆ¶æ•¸
  - å·²é©—è­‰ç”¨æˆ¶æ•¸
- **ç¨ç«‹ç®¡ç†é é¢**ï¼š`/admin.html`
- **è‡ªå‹•åˆ·æ–°**ï¼šæ¯ 30 ç§’æ›´æ–°æ•¸æ“š

### ğŸ“§ Email åŠŸèƒ½
- **é©—è­‰éƒµä»¶**ï¼šè¨»å†Šå¾Œè‡ªå‹•ç™¼é€
- **é‡ç™¼é©—è­‰**ï¼šæ”¯æ´é‡æ–°ç™¼é€é©—è­‰éƒµä»¶ï¼ˆ5 åˆ†é˜å†·å»ï¼‰
- **è¯çµ¡è¡¨å–®**ï¼šç”¨æˆ¶å¯é€éè¡¨å–®è¯ç¹«ç®¡ç†å“¡

---

## ğŸ›  æŠ€è¡“æ¶æ§‹

### å¾Œç«¯
- **Node.js** + **Express.js** - Web æ¡†æ¶
- **MongoDB** + **Mongoose** - è³‡æ–™åº«
- **JWT** - èº«ä»½é©—è­‰
- **bcryptjs** - å¯†ç¢¼åŠ å¯†
- **Multer** - æª”æ¡ˆä¸Šå‚³
- **Nodemailer** - Email ç™¼é€

### å‰ç«¯
- **Vanilla JavaScript** - ç„¡æ¡†æ¶ï¼Œç´” JS
- **SPA æ¶æ§‹** - å–®é æ‡‰ç”¨ç¨‹å¼
- **Responsive Design** - éŸ¿æ‡‰å¼è¨­è¨ˆ
- **Modern CSS** - ç¾ä»£åŒ–æ¨£å¼

### å®‰å…¨æ€§
- **JWT Token** èªè­‰
- **å¯†ç¢¼ Hash** (bcrypt)
- **Email é©—è­‰** æ©Ÿåˆ¶
- **Role-based Access Control** (RBAC)
- **Middleware ä¿è­·** æ•æ„Ÿè·¯ç”±

---

## ğŸ’» ç³»çµ±éœ€æ±‚

- **Node.js**: >= 14.0.0
- **MongoDB**: >= 4.4
- **npm**: >= 6.0.0
- **Gmail å¸³è™Ÿ**ï¼šç”¨æ–¼ç™¼é€é©—è­‰éƒµä»¶ï¼ˆéœ€è¦ App Passwordï¼‰

---

## ğŸ“¦ å®‰è£æ­¥é©Ÿ

### 1. Clone å°ˆæ¡ˆ

```bash
git clone <repository-url>
cd 114_web_final
```

### 2. å®‰è£ä¾è³´å¥—ä»¶

```bash
npm install
```

### 3. è¨­å®šç’°å¢ƒè®Šæ•¸

è¤‡è£½ `.env.example` ä¸¦é‡æ–°å‘½åç‚º `.env`ï¼š

```bash
cp .env.example .env
```

ç·¨è¼¯ `.env` æª”æ¡ˆï¼Œå¡«å…¥ä»¥ä¸‹è³‡è¨Šï¼š

```env
# MongoDB Connection
MONGO_URI=mongodb://localhost:27017/photomission

# JWT Secret (è«‹ä½¿ç”¨å¼·å¯†ç¢¼)
JWT_SECRET=your_super_secret_jwt_key_here

# Admin Secret (ç”¨æ–¼å»ºç«‹ç®¡ç†å“¡)
ADMIN_SECRET_KEY=your_admin_secret_key_here

# Email Configuration (Gmail)
EMAIL_USER=your-email@gmail.com
EMAIL_PASS=your-gmail-app-password
EMAIL_FROM=PhotoMission <noreply@photomission.com>

# Server Configuration
PORT=3001
BASE_URL=http://localhost:3001
```

### 4. è¨­å®š Gmail App Password

1. å‰å¾€ [Google Account Security](https://myaccount.google.com/security)
2. å•Ÿç”¨ã€Œå…©æ­¥é©Ÿé©—è­‰ã€
3. å‰å¾€ [App Passwords](https://myaccount.google.com/apppasswords)
4. é¸æ“‡ã€Œéƒµä»¶ã€å’Œã€Œå…¶ä»–ï¼ˆè‡ªè¨‚åç¨±ï¼‰ã€
5. ç”¢ç”Ÿå¯†ç¢¼ä¸¦è¤‡è£½åˆ° `.env` çš„ `EMAIL_PASS`

### 5. åˆå§‹åŒ–è³‡æ–™åº«

```bash
npm run init-db
```

é€™æœƒå»ºç«‹ï¼š
- 8 å€‹æ”å½±ç« ç¯€
- æ¯å€‹ç« ç¯€çš„ä»»å‹™
- ç¯„ä¾‹è³‡æ–™

### 6. å»ºç«‹ç®¡ç†å“¡å¸³è™Ÿ

```bash
node promote_admin.js <your-email@example.com>
```

---

## ğŸš€ å•Ÿå‹•å°ˆæ¡ˆ

### é–‹ç™¼æ¨¡å¼ï¼ˆè‡ªå‹•é‡å•Ÿï¼‰

```bash
npm run dev
```

### æ­£å¼æ¨¡å¼

```bash
npm start
```

ä¼ºæœå™¨æœƒåœ¨ `http://localhost:3001` å•Ÿå‹•

---

## ğŸ“ å°ˆæ¡ˆçµæ§‹

```
114_web_final/
â”œâ”€â”€ config/
â”‚   â””â”€â”€ db.js                 # MongoDB é€£ç·šè¨­å®š
â”œâ”€â”€ middleware/
â”‚   â”œâ”€â”€ auth.js              # JWT èªè­‰ middleware
â”‚   â”œâ”€â”€ admin.js             # ç®¡ç†å“¡æ¬Šé™æª¢æŸ¥
â”‚   â”œâ”€â”€ verifiedOnly.js      # Email é©—è­‰æª¢æŸ¥
â”‚   â””â”€â”€ pageViewTracker.js   # é é¢ç€è¦½è¿½è¹¤
â”œâ”€â”€ models/
â”‚   â”œâ”€â”€ User.js              # ç”¨æˆ¶æ¨¡å‹
â”‚   â”œâ”€â”€ Chapter.js           # ç« ç¯€æ¨¡å‹
â”‚   â”œâ”€â”€ Task.js              # ä»»å‹™æ¨¡å‹
â”‚   â”œâ”€â”€ Submission.js        # ä½œå“æäº¤æ¨¡å‹
â”‚   â”œâ”€â”€ Contact.js           # è¯çµ¡è¡¨å–®æ¨¡å‹
â”‚   â””â”€â”€ Analytics.js         # åˆ†ææ•¸æ“šæ¨¡å‹
â”œâ”€â”€ routes/
â”‚   â”œâ”€â”€ auth.js              # èªè­‰è·¯ç”± (è¨»å†Š/ç™»å…¥/é©—è­‰)
â”‚   â”œâ”€â”€ api.js               # ä¸»è¦ API è·¯ç”±
â”‚   â””â”€â”€ admin.js             # ç®¡ç†å“¡è·¯ç”±
â”œâ”€â”€ services/
â”‚   â”œâ”€â”€ AuthService.js       # èªè­‰æœå‹™
â”‚   â”œâ”€â”€ ChapterService.js    # ç« ç¯€æœå‹™
â”‚   â”œâ”€â”€ TaskService.js       # ä»»å‹™æœå‹™
â”‚   â”œâ”€â”€ SubmissionService.js # ä½œå“æœå‹™
â”‚   â””â”€â”€ EmailService.js      # Email æœå‹™
â”œâ”€â”€ repositories/
â”‚   â”œâ”€â”€ UserRepository.js    # ç”¨æˆ¶è³‡æ–™å­˜å–
â”‚   â”œâ”€â”€ ChapterRepository.js # ç« ç¯€è³‡æ–™å­˜å–
â”‚   â”œâ”€â”€ TaskRepository.js    # ä»»å‹™è³‡æ–™å­˜å–
â”‚   â””â”€â”€ SubmissionRepository.js # ä½œå“è³‡æ–™å­˜å–
â”œâ”€â”€ public/
â”‚   â”œâ”€â”€ index.html           # ä¸»é é¢
â”‚   â”œâ”€â”€ admin.html           # ç®¡ç†å“¡å„€è¡¨æ¿
â”‚   â”œâ”€â”€ css/
â”‚   â”‚   â””â”€â”€ styles.css       # æ¨£å¼è¡¨
â”‚   â””â”€â”€ js/
â”‚       â”œâ”€â”€ app.js           # ä¸»è¦å‰ç«¯é‚è¼¯
â”‚       â”œâ”€â”€ eventBus.js      # äº‹ä»¶ç¸½ç·š
â”‚       â””â”€â”€ componentFactory.js # å…ƒä»¶å·¥å» 
â”œâ”€â”€ scripts/
â”‚   â”œâ”€â”€ seed.js              # è³‡æ–™åº«åˆå§‹åŒ–è…³æœ¬
â”‚   â””â”€â”€ verify-existing-users.js # ç”¨æˆ¶é©—è­‰è…³æœ¬
â”œâ”€â”€ uploads/                 # ä¸Šå‚³æª”æ¡ˆç›®éŒ„
â”œâ”€â”€ .env                     # ç’°å¢ƒè®Šæ•¸ï¼ˆä¸ç´å…¥ç‰ˆæ§ï¼‰
â”œâ”€â”€ .env.example             # ç’°å¢ƒè®Šæ•¸ç¯„ä¾‹
â”œâ”€â”€ server.js                # ä¼ºæœå™¨å…¥å£
â””â”€â”€ package.json             # å°ˆæ¡ˆè¨­å®š
```

---

## ğŸ”Œ API æ–‡ä»¶

### èªè­‰ç›¸é—œ

| Method | Endpoint | èªªæ˜ | æ¬Šé™ |
|--------|----------|------|------|
| POST | `/api/auth/register` | è¨»å†Šæ–°ç”¨æˆ¶ | Public |
| POST | `/api/auth/login` | ç”¨æˆ¶ç™»å…¥ | Public |
| GET | `/api/auth/verify/:token` | Email é©—è­‰ | Public |
| POST | `/api/auth/resend-verification` | é‡ç™¼é©—è­‰éƒµä»¶ | Public |
| GET | `/api/auth/me` | å–å¾—ç•¶å‰ç”¨æˆ¶è³‡æ–™ | Private |

### ç« ç¯€èˆ‡ä»»å‹™

| Method | Endpoint | èªªæ˜ | æ¬Šé™ |
|--------|----------|------|------|
| GET | `/api/chapters` | å–å¾—æ‰€æœ‰ç« ç¯€ | Public |
| GET | `/api/chapters/:id` | å–å¾—å–®ä¸€ç« ç¯€ | Public |
| GET | `/api/chapters/:id/tasks` | å–å¾—ç« ç¯€ä»»å‹™ | Public |

### ä½œå“ç®¡ç†

| Method | Endpoint | èªªæ˜ | æ¬Šé™ |
|--------|----------|------|------|
| POST | `/api/submissions` | æäº¤ä½œå“ | Private + Verified |
| GET | `/api/submissions` | å–å¾—æ‰€æœ‰ä½œå“ | Public |
| GET | `/api/submissions/user/:userId` | å–å¾—ç”¨æˆ¶ä½œå“ | Public |
| PUT | `/api/submissions/:id` | æ›´æ–°ä½œå“ | Private + Verified |
| DELETE | `/api/submissions/:id` | åˆªé™¤ä½œå“ | Private + Verified |

### ç®¡ç†å“¡

| Method | Endpoint | èªªæ˜ | æ¬Šé™ |
|--------|----------|------|------|
| GET | `/api/admin/analytics` | å–å¾—åˆ†ææ•¸æ“š | Admin |
| POST | `/api/analytics/click` | è¨˜éŒ„é»æ“Šäº‹ä»¶ | Public |

---

## ğŸ” ç®¡ç†å“¡åŠŸèƒ½

### è¨ªå•ç®¡ç†å“¡å„€è¡¨æ¿

1. **å»ºç«‹ç®¡ç†å“¡å¸³è™Ÿ**ï¼š
   ```bash
   node promote_admin.js <your-email>
   ```

2. **ç™»å…¥ç³»çµ±**

3. **è¨ªå•å„€è¡¨æ¿**ï¼š
   - æ–¹å¼ 1ï¼šé»æ“Šé é¢é ‚éƒ¨çš„ã€ŒğŸ”§ ç®¡ç†å“¡ã€é€£çµ
   - æ–¹å¼ 2ï¼šç›´æ¥è¨ªå• `http://localhost:3001/admin.html`

### å„€è¡¨æ¿åŠŸèƒ½

- **ç¶²ç«™é»æ“Šæ¬¡æ•¸**ï¼šè¿½è¹¤æ‰€æœ‰ç”¨æˆ¶é»æ“Šäº’å‹•
- **æ´»èºå¸³æˆ¶**ï¼š30 å¤©å…§ç™»å…¥çš„å·²é©—è­‰ç”¨æˆ¶
- **ç¸½è¨»å†Šç”¨æˆ¶**ï¼šæ‰€æœ‰è¨»å†Šç”¨æˆ¶æ•¸é‡
- **å·²é©—è­‰ç”¨æˆ¶**ï¼šEmail å·²é©—è­‰çš„ç”¨æˆ¶æ•¸

---

## â“ å¸¸è¦‹å•é¡Œ

### Q: ç„¡æ³•ç™¼é€é©—è­‰éƒµä»¶ï¼Ÿ

**A**: è«‹ç¢ºèªï¼š
1. Gmail App Password æ˜¯å¦æ­£ç¢ºè¨­å®š
2. `.env` ä¸­çš„ `EMAIL_USER` å’Œ `EMAIL_PASS` æ˜¯å¦æ­£ç¢º
3. Gmail å¸³è™Ÿæ˜¯å¦å•Ÿç”¨ã€Œå…©æ­¥é©Ÿé©—è­‰ã€
4. åŸ·è¡Œ `node test_email.js` æ¸¬è©¦éƒµä»¶åŠŸèƒ½

### Q: ç« ç¯€é é¢é¡¯ç¤ºã€Œè¼‰å…¥ä¸­...ã€ï¼Ÿ

**A**: è«‹å˜—è©¦ï¼š
1. å¼·åˆ¶é‡æ–°æ•´ç†ç€è¦½å™¨ï¼ˆCmd+Shift+Rï¼‰
2. ç¢ºèªä¸åœ¨é©—è­‰é é¢ï¼ˆURL ä¸å« `verify-email`ï¼‰
3. é»æ“Šã€Œå­¸ç¿’ç« ç¯€ã€æˆ–ã€ŒPhotoMissionã€logo è¿”å›é¦–é 
4. æª¢æŸ¥ç€è¦½å™¨ Console æ˜¯å¦æœ‰éŒ¯èª¤

### Q: å¦‚ä½•é‡ç½®è³‡æ–™åº«ï¼Ÿ

**A**: 
```bash
# åˆªé™¤è³‡æ–™åº«
mongo photomission --eval "db.dropDatabase()"

# é‡æ–°åˆå§‹åŒ–
npm run init-db
```

### Q: å¿˜è¨˜ç®¡ç†å“¡å¯†ç¢¼ï¼Ÿ

**A**:
```bash
# é‡æ–°è¨­å®šç‚ºç®¡ç†å“¡
node promote_admin.js <your-email>
```

### Q: ä¸Šå‚³çš„ç…§ç‰‡å„²å­˜åœ¨å“ªè£¡ï¼Ÿ

**A**: ç…§ç‰‡å„²å­˜åœ¨ `uploads/` ç›®éŒ„ä¸­ï¼Œæª”åæ ¼å¼ç‚º `{timestamp}-{originalname}`

---

## ğŸ“ é–‹ç™¼æŒ‡ä»¤

```bash
# å®‰è£ä¾è³´
npm install

# å•Ÿå‹•é–‹ç™¼ä¼ºæœå™¨ï¼ˆè‡ªå‹•é‡å•Ÿï¼‰
npm run dev

# å•Ÿå‹•æ­£å¼ä¼ºæœå™¨
npm start

# åˆå§‹åŒ–è³‡æ–™åº«
npm run init-db

# å»ºç«‹ç®¡ç†å“¡
node promote_admin.js <email>

# æª¢æŸ¥ç”¨æˆ¶é€²åº¦
node check_user_progress.js <email>

# æ¸¬è©¦éƒµä»¶åŠŸèƒ½
node test_email.js
```

---

## ğŸ¤ è²¢ç»

æ­¡è¿æäº¤ Issue å’Œ Pull Requestï¼

---

## ğŸ“„ æˆæ¬Š

ISC License

---

## ğŸ‘¨â€ğŸ’» ä½œè€…

**Morris Lee ï¼† Antigravity Team**

---

## ğŸ™ è‡´è¬

- Express.js åœ˜éšŠ
- MongoDB åœ˜éšŠ
- æ‰€æœ‰é–‹æºè²¢ç»è€…

---

**äº«å—æ‚¨çš„æ”å½±å­¸ç¿’ä¹‹æ—…ï¼ğŸ“¸**
